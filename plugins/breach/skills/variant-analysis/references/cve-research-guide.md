# CVE Research Guide

Methodology for researching a CVE to extract vulnerability patterns applicable to variant analysis.

## Step 1: Retrieve CVE Details

Search for the CVE ID to get the official record:

1. **NVD (National Vulnerability Database)**: `https://nvd.nist.gov/vuln/detail/{CVE-ID}` — provides CVSS score, CWE classification, affected versions, and description
2. **MITRE CVE**: `https://cve.mitre.org/cgi-bin/cvename.cgi?name={CVE-ID}` — canonical CVE entry
3. **GitHub Advisory Database**: Search `https://github.com/advisories?query={CVE-ID}` — often links directly to patch commits
4. **Vendor advisory**: Check the affected product's security advisories page

Extract from the CVE record:
- **Vulnerability type** (CWE classification)
- **Affected product and versions**
- **Description** (often contains enough to understand the pattern)
- **References** (links to patches, advisories, writeups)

## Step 2: Find the Patch Commit

The patch commit is the most valuable artifact — it shows exactly what was vulnerable and how it was fixed.

1. **GitHub Advisory**: Often links directly to the patch commit or PR
2. **Commit message search**: Search the affected project's git history for the CVE ID: `git log --all --oneline --grep="{CVE-ID}"`
3. **Changelog search**: Check CHANGELOG, HISTORY, or release notes mentioning the CVE
4. **NVD references**: The "References" section often includes patch URLs
5. **Security mailing lists**: Search oss-security, full-disclosure for the CVE ID
6. **Vendor advisory links**: Vendor security pages often link to the specific patch

## Step 3: Analyze the Patch Diff

Read the patch diff carefully:

1. **Before (vulnerable pattern)**:
   - What does the code do?
   - Where does user input enter?
   - What dangerous operation is performed?
   - What control is missing?

2. **After (safe pattern)**:
   - What was added? (validation, sanitization, authorization, parameterization)
   - What was changed? (API call, configuration, flow)
   - What was removed? (dangerous function, unused feature)

3. **Extract structural pattern**:
   - The "before" code defines the vulnerable pattern
   - The "after" code defines what the fix looks like
   - The difference is the missing control

## Step 4: Assess Applicability

Before searching the target codebase:

1. **Technology match**: Does the target use the same or similar technology?
   - Same language? Same framework? Same library?
   - If not, is there an analog in the target's stack?

2. **Pattern generalizability**: Is this a product-specific bug or a general pattern?
   - Product-specific: exact same misconfiguration, specific to that product's API
   - General pattern: common coding mistake that could exist in any application

3. **Version relevance**: If the CVE is in a dependency:
   - Check if the target uses the affected dependency
   - Check the version (may already be patched)
   - Check if the vulnerable feature is actually used

## Step 5: Generate Variant Search

Based on the extracted pattern:

1. **Direct variant**: Same technology, same pattern — search for identical vulnerable code
2. **Analog variant**: Different technology, same concept — search for the same type of flaw
3. **Incomplete fix variant**: Same codebase as the CVE — check if the fix was applied consistently everywhere

Proceed to Phase 2 (Rule Generation) of the variant analysis skill.

## Common CVE Pattern Categories

| CVE Pattern | What to Extract | What to Search For |
|-------------|----------------|-------------------|
| Missing input validation | Which input, which validation was added | Other inputs missing the same validation |
| Auth bypass | What check was missing, what was added | Other endpoints missing the same check |
| Injection | What sink, what sanitization was added | Other sinks missing the same sanitization |
| Deserialization | What deserializer, what restriction was added | Other deserialization points without restrictions |
| SSRF | What URL handling, what validation was added | Other URL-accepting code without validation |
| Path traversal | What file operation, what path validation was added | Other file operations without path validation |
